package com.mobit;


import android.app.Activity;
import android.media.Ringtone;
import android.media.RingtoneManager;
import android.net.Uri;

import com.zebra.sdk.comm.BluetoothConnection;


import com.zebra.sdk.comm.ConnectionException;
import com.zebra.sdk.printer.ZebraPrinter;
import com.zebra.sdk.printer.ZebraPrinterFactory;

import java.util.ArrayList;
import java.util.List;

import mobit.eemr.GucTespit;
import mobit.eemr.OlcuDevreForm;

public class Yazici {
    public static int bluetooth_kontrol = 0;
    private static int testbluetooth_kontrol = 0;
    private static int yazici_hizi = 1000;
    private static BluetoothConnection org_connection;



    public Yazici() {

    }

    public Yazici(int yazici_hizi) {
        this.yazici_hizi = yazici_hizi;
    }

    //HÜSEYİN EMRE ÇEVİK TOPLU FATURALARDA 5SN BEKLEME HATASI ÇÖZÜMÜ 20.04.2021
    static public BluetoothConnection YaziciBluetoothControl(String ConString) {

        try {
            if (bluetooth_kontrol == 0) {
                //  org_connection = new BluetoothConnection(ConString);
                org_connection = new BluetoothConnection(ConString);
                ((BluetoothConnection) org_connection).open();
                bluetooth_kontrol++;
                return org_connection;
            }

            if (((BluetoothConnection) org_connection).isConnected()) {
                return org_connection;
            } else {
                org_connection = null;
                org_connection = new BluetoothConnection(ConString);
                ((BluetoothConnection) org_connection).open();
                return org_connection;
            }
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    }

    public void Yazdir(String ConString, String Data) {

        try {

            if (YaziciBluetoothControl(ConString) != null) {
                ZebraPrinter printer = ZebraPrinterFactory.getInstance(((BluetoothConnection) org_connection));

                // Open the connection - physical connection is established here.


                String zpl = Data;

                printer.sendCommand("! U1 setvar \"device.languages\" \"zpl\"\r\n");
                Thread.sleep(yazici_hizi);
                //printer.sendCommand("~DGR:PERAKENDE_IMZA2.GRF,7350,70,zzk02lY02J01lT06J01lT04J03W0HFkU08J02W0E3F8M08kJ018J02W0E07FEK078kJ018J06W0EI0F8J0EkK03K06W0EJ0FCH018kK03K04W07J07F80FkL02K04W07K01C0CkL06K0CW07L0E38kL06K08W03L01EkM0CK08W01L07CkM0CK08W018K0F6kJ01018J018W01CJ03C6kJ02018J01X01CJ0F03kJ0203K03Y0EI01C03kJ0403K03Y0EI0F803kJ0407K03Y07H01CH06kJ0806K06Y07H038H0CkJ0806K06Y0301EI08kI01804I0306L01CQ01878023kJ01H0CI0304L07EQ019F87F7kJ03H0CI018CK01HCQ01FE0F7CkJ02H08I010CK0718R0F83868kJ06H08I0108K0E7R01F1E0F8kJ04018J018J038CR03EFH06kK04018J018J0638R0F38018kK08038J03J01C6R07H980CkK018038J031I031CR0F71838kK018028J0H3I0E3R01FE0878kK01H068J023H018EQ01HFC0CEkL03H048J063H0318Q07FCH0F8kL02H0C8J062H0E7R0HF8H0FkM06H0H8J0C6018CQ07HF01HF8kL0401H8J0HC0H3Q01DFH07618kL0401H8I01D80HEQ039F01HC08kL0C0108I01901F8Q0HFE1F180CkL080308I01903EQ01JF03H0CkL0803H8I03B078P01HFCH018H07kK01807082H0320FQ03EFI03I03kK0101E0C260321CK03LF7CH038I018kJ0107C0CH63F238L0D7803DFI06K08kJ020E40CH6HF2FM03I07DFI0EK08kJ023840C6EFH7EM03I0DBEH018K0CkJ02E080C7HF378N0C03DFI0EL06kJ07C080CIF398N0407DFH018L02kJ07H0804FC7F3Q0D3EH01M03kJ0401804F87E6P07DFH018M018kI0801H04F06HCO01D7EH03O08kI0803H05F1ICO01BDEH07O08kI0803H04H70C8O03HFC01EO08kH01802H043C0D8O0D9FH07P0CkH01H02H0478098N01B3EH0EP04kH03H06H06EH08CN03HFC01CkS03H04H078H086N07FDH03kT02H04H0EH018N01HFC038kT06H0C03CH018N07FD806kU06H080E4H018M0IFE07kV04018384Q0FH980EkV0C018F0CQ0D1981CkV08019C0CP01FH303kW0801FH08P03CFE0EkV01803CH08P0DH183kW09H03I08O01B3107kW091CFI08O01BC63kX0B7H3I08O0378C7kX0BCE2H018O0B709CkX0F382H018N01E7038kT01801HEJ01P01F1CkU03H07F8J01P0707kV0601EFK03P06kX0C078CK03O018kW0181E3CK02O038kW01078F8K06O07kX021F398K06O0EkX03FCEM06N038kY0738M04N06l0C7W0EkY031CV03l0E7W06kY018EW06kY0738V03kY01CEW02kY0318V01EkY0E7W038kX031CW02kY067X0EkX018CW01CkX0738W03kY0CEX06kX0398W01EkX067X038kW019CX0EkX0H7X03kY0FCX03kX01FX01CkX01CX038kX018X02j0\n"+
                //        "^XA\n" +
                //        "^FO20,20^XGR:PERAKENDE_IMZA2.GRF,1,1^FS\n" +
                //        "^XZ");
                // Send the data to printer as a byte array.
			    /*
                printer.sendCommand("^XA\n" +
                        "^FO50,50\n" +
                        "^A0,32,25\n" +
                        "^FDZEBRA^FS\n" +
                        "^FO50,150\n" +
                        "^A0,32,25\n" +
                        "^FDPROGRAMMING^FS\n" +
                        "^FO50,250\n" +
                        "^A0,32,25^FDLANGUAGE^FS\n" +
                        "^XZ");
			     */
                printer.sendCommand(zpl);

                //2 faturada bir bağlantı kur
               /* testbluetooth_kontrol+=bluetooth_kontrol;
                if (testbluetooth_kontrol==2){
                    baglanti_kapat();
                    testbluetooth_kontrol=0;
                }*/

                // connection.close();

//                setPrinterLanguageToZPL();
                //              storeFormat();
                // if (getStatusBeforePrint()) {
                // printFormat();
                // getStatusAfterPrint();
                // }
            } else {
            }
        } catch (Exception e) {
            e.printStackTrace();
        } finally {

            //  myLabel.setText("yazdırma tamamlandı");
        }
    }

    public void PerakendeZplGraphicSend(String ConString) {
        BluetoothConnection connection = new BluetoothConnection(ConString);
        try {
            ((BluetoothConnection) connection).open();
            if (((BluetoothConnection) connection).isConnected()) {
                ZebraPrinter printer = ZebraPrinterFactory.getInstance(((BluetoothConnection) connection));
                printer.sendCommand("! U1 setvar \"device.languages\" \"zpl\"\r\n");
                Thread.sleep(500);
                //HÜSEYİN EMRE ÇEVİK LOGO GÖNDERME 02.04.2021
                printer.sendCommand("~DGR:PERAKENDE_IMZA2.GRF,7350,70,zzk02lY02J01lT06J01lT04J03W0HFkU08J02W0E3F8M08kJ018J02W0E07FEK078kJ018J06W0EI0F8J0EkK03K06W0EJ0FCH018kK03K04W07J07F80FkL02K04W07K01C0CkL06K0CW07L0E38kL06K08W03L01EkM0CK08W01L07CkM0CK08W018K0F6kJ01018J018W01CJ03C6kJ02018J01X01CJ0F03kJ0203K03Y0EI01C03kJ0403K03Y0EI0F803kJ0407K03Y07H01CH06kJ0806K06Y07H038H0CkJ0806K06Y0301EI08kI01804I0306L01CQ01878023kJ01H0CI0304L07EQ019F87F7kJ03H0CI018CK01HCQ01FE0F7CkJ02H08I010CK0718R0F83868kJ06H08I0108K0E7R01F1E0F8kJ04018J018J038CR03EFH06kK04018J018J0638R0F38018kK08038J03J01C6R07H980CkK018038J031I031CR0F71838kK018028J0H3I0E3R01FE0878kK01H068J023H018EQ01HFC0CEkL03H048J063H0318Q07FCH0F8kL02H0C8J062H0E7R0HF8H0FkM06H0H8J0C6018CQ07HF01HF8kL0401H8J0HC0H3Q01DFH07618kL0401H8I01D80HEQ039F01HC08kL0C0108I01901F8Q0HFE1F180CkL080308I01903EQ01JF03H0CkL0803H8I03B078P01HFCH018H07kK01807082H0320FQ03EFI03I03kK0101E0C260321CK03LF7CH038I018kJ0107C0CH63F238L0D7803DFI06K08kJ020E40CH6HF2FM03I07DFI0EK08kJ023840C6EFH7EM03I0DBEH018K0CkJ02E080C7HF378N0C03DFI0EL06kJ07C080CIF398N0407DFH018L02kJ07H0804FC7F3Q0D3EH01M03kJ0401804F87E6P07DFH018M018kI0801H04F06HCO01D7EH03O08kI0803H05F1ICO01BDEH07O08kI0803H04H70C8O03HFC01EO08kH01802H043C0D8O0D9FH07P0CkH01H02H0478098N01B3EH0EP04kH03H06H06EH08CN03HFC01CkS03H04H078H086N07FDH03kT02H04H0EH018N01HFC038kT06H0C03CH018N07FD806kU06H080E4H018M0IFE07kV04018384Q0FH980EkV0C018F0CQ0D1981CkV08019C0CP01FH303kW0801FH08P03CFE0EkV01803CH08P0DH183kW09H03I08O01B3107kW091CFI08O01BC63kX0B7H3I08O0378C7kX0BCE2H018O0B709CkX0F382H018N01E7038kT01801HEJ01P01F1CkU03H07F8J01P0707kV0601EFK03P06kX0C078CK03O018kW0181E3CK02O038kW01078F8K06O07kX021F398K06O0EkX03FCEM06N038kY0738M04N06l0C7W0EkY031CV03l0E7W06kY018EW06kY0738V03kY01CEW02kY0318V01EkY0E7W038kX031CW02kY067X0EkX018CW01CkX0738W03kY0CEX06kX0398W01EkX067X038kW019CX0EkX0H7X03kY0FCX03kX01FX01CkX01CX038kX018X02j0");
                //     printer.sendCommand("~DGR:PERAKENDE_IMZA2.GRF,5000,25,zzzzzzzkN028gR07AT0HAK0DBH0EF06HDHB0B6E8I01BCI014A8R0154J01H5813182A54A0AB2AJ0A6I01H5S02ABK0HA80CE0H5AB50I54I0158I02HACR0I58J0AD01H5856AD50IABI0156I0H568R05B54I01H501H502JA05AD5I0154I056HAR0JAJ0HA80HA8K50JA8H02HAI05HACQ01I54I016A815A85JA0HAB5I016AI0JAQ016HABJ0AB016A82AD560I56CH02ABI0IABQ02JAI01H540HA8I5B50B6HA8H02ACI0HAD5Q01J5J0HA81H50K50KAH01H5H01J5Q0H56EA8I0AD41H502JA0J54H02HAH015IAQ02IABI01H581HA85BI50HADHAH02D5I0HAB58P05BI54I0HA82AD0H56HA0AD2HAH035AH0154HA8P0HABH54H016AC1H582HAB5054154H04ABH0168H5Q0I5HA8I0HA82HA0I54A0A80ACH03H5H01502A8P0IAD56H01H542B58H5J0B40B6H0I5H01582BQ0BI56AI0AD41H505AJ054052H0I5802A02DP01H5JAI0HA82HA82BJ0A80H5H02HA80158128P0HABIAH01H542D5054J0AC02BH056DH02A82DP0156DI5I0HAC156857J0A802CH05HA8016815P01IA5HAH016D42HA829J0A802BH0I5H02A81Q02B402B5I0IA2HA856J05402AH0IA80156R015402HAH01H542D505AJ0B402AH0A95801AB4Q02AC01H5I0IAH5682AJ0A8015H0H56801H54Q02A8H0ABI0IA2950H5H4A0A802BH0ACAC015HAQ02ACH0B580152CI50I5B40AC02A80B15H01I5Q02B4H0HAI0IA595856IA054015H0ACAC01I58P0H5420AB8015HA29602JA0A802A80A8A801H564P02AC58548H0IAI58J540B4015H0A8A8H0JAP0H54685680152A29505AB54054016815454H0B6B4P05A8542A8H0IA54A82AD6A0A802A8158ACH0IABP02ACHAH54H0D2A5950J540A8015H0A8B6H0J5P0H54645A8015952968J560540150150A8H0H5HAP056C5IA8H0A9AI502JA0A8016816856H05HAD8O0H546D9540154B59505BH540B401A80A8HAH02IAP0HA86B2AH80A9H54A8H56B4054015015054H02HAB8N09H5CB62B420A8HA950J560A801502A86AH01H548O02045B1080151H50A82IA80AC02A8168H5I0ADBR0H4A28C80A9HA950J5605H01502A854I0I54O0214562840169H51685AJ0AC02A82A82BI02HA8O0A6CH528A20A95A950H5J0B401502D0H5J0HACP0545610A8154AB15856J05402A81H56DJ0H5O08A586B2A420A8HA8A02AJ0A801602ABH5J02ACO080CH52080151H5158H5J0A802B02AD54H0502D4N0H208H512C10D8HA960H5J0540148J570350154N02A0CADH210154B50A856J0A802B02DH540150154P068H5104H0A8HA9502AJ0B402C0K582A8154O0A545A26H4150AB158H5J0A802B0I5HA82A80A8N0H854H5102H0A8AD0A05AJ0AC02A02AD5A82D0154O026CH52040154H5158H5J05H02A05BI502A8168N04A145410480A8HA1682AH020AC0H50K50150154N052045A2520154HA0A0H5B790B40H50J5682A8154O08046A05010B0H515856HA60A80HA0KA82B42A8N0920C5425H0154B61502JA0540AC0I56A81542A8O0HA45652CA0A8H5150K50HAB540AD5HA82IABO02H58505AH80A8H50A85IAD0KA0B5HAD41J5P05AC5C4A80150H5150I5B50J540HA015416B6A8O0H545435H40A85A0D82ADH50B6AB40HA01541J5P0H545056H8168H5150K50HAD540HA01581I568O02AC60H54H0A8540A856IA0I5A80HA01540AD5AP0568H0HAH8154561505JA0JA815401540B565P05AC20HA8H0A8541582ABH50ADH5H0HA01540JAP02A820B5H01502A0A0I56D0J50168H0HA0I54P0H5H41568H0A854158K50JA8154016A0I5AP02AC01H5H01585A1682JA0B56C0158H0HA02HA8P02A842HA8H0A82A0A0H5HAB0H5HA0154H0HA02B54P02AD4AD5I0A85415856IA0IAH0154H0HA01568P01H53H5A8P08H1K08L01I0A9Q02LAgP054Q016D56ABgP056Q01LAgP054R0HABI5gP0H5Q01J5B4gP0HAR0LAgP0ADR0DJ54gQ0AR0LAgQ0BR054AD54gQ0AR0AEB5A8U02U05R052HAB4g0CP0AR02DI5V02S012BR034IA8I09H5248645152891484HA4841I0HAR02JA8H01265H2C5454IA2148A294821H01H5R01J5J09521H420452A0A1H4A95284280154R015B6AI01245328I4H10A804H82928408H0HAS0IACI01280108H406H2861090H850H2H015AS0JAJ09H5H2820721H2814C89128A18H0D4S0I54I0H125H145H45128A05128950208H02T0I5K048I5J45H12AH14AH12H808W02ADJ015H45104H04128A1H508928624W016AK0H4529404CH1H25048A9050AH8X054J0H130490H63520A9156A092892AgK04A549432A0928014049148152gJ01O04I09H02L0H8jY08hN01zzzzzsG0");
                /*
                printer.sendCommand("^XA\n" +
                        "^FO20,20\n" +
                        "^B3N,N,100,Y\n" +
                        "^FDTEST+$$M$J-$^FS\n" +
                        "^XZ");

                 */
                connection.close();
            } else {


            }
        } catch (Exception e) {
            e.printStackTrace();
        } finally {

            //  myLabel.setText("yazdırma tamamlandı");
        }
    }

    //HÜSEYİN EMRE ÇEVİK 24.03.2021 ( YAZICILARDA BLUETOOTH KAPANMA SORUNU )
    public void denemeZebra(String ConString) {
        BluetoothConnection connection = new BluetoothConnection(ConString);
        try {
            ((BluetoothConnection) connection).open();
            if (((BluetoothConnection) connection).isConnected()) {
                ZebraPrinter printer = ZebraPrinterFactory.getInstance(((BluetoothConnection) connection));


                //       printer.sendCommand(new String(command, StandardCharsets.UTF_8));

                printer.sendFileContents("/storage/emulated/0/Android/data/yazici_ayar.txt");

                /*
                printer.sendCommand("^XA\n" +
                        "^FO20,20\n" +
                        "^B3N,N,100,Y\n" +
                        "^FDTEST+$$M$J-$^FS\n" +
                        "^XZ");

                 */
                connection.close();
            } else {


            }
        } catch (Exception e) {
            e.printStackTrace();
        } finally {

            //  myLabel.setText("yazdırma tamamlandı");
        }
    }

    //HÜSEYİN EMRE ÇEVİK - OKUMAYAP A GİRERKEN İMZA ATMA SORUNU ÇÖZÜM 09.03.2021
    public int bluetoothBagliMi(String ConString) {
        BluetoothConnection connection = new BluetoothConnection(ConString);

        try {
            ((BluetoothConnection) connection).open();

            if (((BluetoothConnection) connection).isConnected()) return 1;
            else return 0;


        } catch (Exception e) {
            e.printStackTrace();
            return 0;
        }


    }

    public int getYazici_hizi() {
        return yazici_hizi;
    }

    public void setYazici_hizi(int yazici_hizi) {
        this.yazici_hizi = yazici_hizi;
    }

    public void baglanti_kapat() {
        try {
            bluetooth_kontrol = 0;
            org_connection.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
